<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">

        <script type="text/javascript" src="libs/jquery/1.7.1/jquery.min.js"></script>
        <script type="text/javascript" src="libs/jquery/1.7.1/jquery-base64.min.js"></script>

        <script type="text/javascript" src="libs/jqueryui/1.8.16/jquery-ui.min.js"></script>

        <script type="text/javascript" src="libs/syntaxhighligher/3.0.83/js/shCore.js"></script>
        <script type="text/javascript" src="libs/syntaxhighligher/3.0.83/js/shBrushJScript.js"></script>

        <link rel="stylesheet" type="text/css" href="libs/syntaxhighligher/3.0.83/css/shCore.css">
        <link rel="stylesheet" type="text/css" href="style.css">

        <script type="text/javascript" src="present.js"></script>
        <script type="text/javascript" src="dependencies.js"></script>
        <script type="text/javascript" src="cmc.js"></script>

        <title>SDK Рутокен Плагин</title>

    </head>
    <body>
        <div id="container">
            <header id="header">
                <dl>
                    <dt><img src="images/logo_rutoken.png" width="165" height="71" alt="" /></dt>
                    <dd>
                        <ul>
                            <li><a href="http://www.rutoken.ru/products/all/rutoken-plugin/" target="_blank">Рутокен Плагин</a></li>
                            <li><a href="http://www.rutoken.ru/support/download/rutoken-plugin/" target="_blank">Загрузить</a></li>
                            <li><a href="https://dev.rutoken.ru/display/PUB/RutokenPluginDoc" target="_blank">Документация</a></li>
                            <li><a href="http://forum.rutoken.ru/forum/15/" target="_blank">Форум</a></li>
                        </ul>
                    </dd>
                </dl>
            </header>
            <div id="content">
                <div class="common">
                    <dl>
                        <dt><label for="device-list">Доступные устройства:</label></dt>
                        <dd>
                            <select id="device-list">
                                <option>Обновите список устройств</option>
                            </select>
                            <button id="refresh-dev">↓↑</button>
                        </dd>
                    </dl><dl>
                        <dt><label for="device-list">PIN-код:</label></dt>
                        <dd>
                            <input    id="device-pin" type="text"    value="12345678" />
                            <button id="login">Войти</button>
                            <button id="logout">Выйти</button>
                            <button id="save-pin">Сохранить PIN-код</button>
                            <button id="remove-pin">Удалить PIN-код</button>
                        </dd>
                    </dl><dl>
                        <dt><label for="key-list">Ключи на устройстве: </label></dt>
                        <dd>
                            <select id="key-list">
                                <option>Выполните вход на устройство</option>
                            </select>
                            <button id="refresh-keys">↓↑</button>
                        </dd>
                    </dl><dl>
                        <dt><label for="cert-list">Сертификаты на уcтройстве: </label></dt>
                        <dd>
                            <select id="cert-list">
                                <option>Обновите список сертификатов</option>
                            </select>
                            <button id="refresh-certs">↓↑</button>
                        </dd>
                    </dl>
                </div>
                <div id="section">
                    <ul>
                        <li><a href="#section-1"><span>Токены и ключевые пары</span></a></li>
                        <li><a href="#section-2"><span>Запрос на сертификат</span></a></li>
                        <li><a href="#section-3"><span>Работа с сертификатами</span></a></li>
                        <li><a href="#section-4"><span>ЭЦП и аутентификация</span></a></li>
                        <li><a href="#section-5"><span>Шифрование</span></a></li>
                    </ul>
                    <div id="section-1">
                        <div id="DevInfo" class="group">
                            <ul>
                                <li>
                                    <label for="device-info-radio">Тип информации:</label><br>
                                    <label><input class="radio-input" type="radio" name="device-info" value="model" checked="checked"/>Модель</label><br>
                                    <label><input class="radio-input" type="radio" name="device-info" value="reader"/>Считыватель</label><br>
                                    <label><input class="radio-input" type="radio" name="device-info" value="label"/>Метка</label><br>
                                    <label><input class="radio-input" type="radio" name="device-info" value="type"/>Тип устройства</label><br>
                                    <label><input class="radio-input" type="radio" name="device-info" value="serial"/>Серийный номер</label><br>
                                    <label><input class="radio-input" type="radio" name="device-info" value="logged"/>Авторизация</label><br>
                                    <label><input class="radio-input" type="radio" name="device-info" value="formats"/>Поддерживаемые форматы</label><br>
                                    <label><input class="radio-input" type="radio" name="device-info" value="features"/>Возможности устройства</label><br>
                                    <label><input class="radio-input" type="radio" name="device-info" value="mechanisms"/>Поддерживаемые механизмы</label><br>
                                    <label><input class="radio-input" type="radio" name="device-info" value="speed" />Класс скорости</label><br>
                                    <label><input class="radio-input" type="radio" name="device-info" value="free memory" />Свободная память</label><br>
                                    <label><input class="radio-input" type="radio" name="device-info" value="pins"/>Информация о PIN-кодах</label><br>
                                    <label><input class="radio-input" type="radio" name="device-info" value="fkn" />Поддержка ФКН</label><br>
                                </li>
                            </ul>
                        </div>
                        <div id="ChangePin" class="group">
                            <ul>
                                <li>
                                    <label><input type="checkbox" name="use-admin-pin" class="input" />Использовать PIN-код Администратора</label>
                                </li>
                                <li>
                                    <label for="old-pin">Старый PIN-код пользователя или PIN-код Администратора:</label>
                                      <input type="text" class="input" id="old-pin" value="12345678" />
                                </li>
                                <li>
                                    <label for=new-pin>Новый PIN-код:</label>
                                    <input type="text" class="input" id="new-pin" value="123456" />
                                </li>
                            </ul>
                        </div>
                        <div id="UnblockUserPin" class="group">
                            <ul>
                                <li>
                                    <label for=admin-pin>PIN-код Администратора:</label>
                                    <input type="text" id="admin-pin" class="input"/>
                                </li>
                            </ul>
                        </div>
                        <div id="FormatToken" class="group">
                            <ul>
                                <li>
                                    <label for=admin-pin>PIN-код Администратора:</label>
                                    <input type="text" id="admin-pin" class="input"/>
                                </li>
                                <li>
                                    <label for=new-user-pin>Новый PIN-код пользователя:</label>
                                    <input type="text" id="new-user-pin" class="input"/>
                                </li>
                                <li>
                                    <label for=label>Метка:</label>
                                    <input type="text" id="label" class="input"/>
                                </li>
                            </ul>
                        </div>
                        <div id="GenerateKeyPair" class="group">
                            <ul>
                                <li>
                                    <label for="generate-key-id">Id ключа:</label><br>
                                    <label><input type="checkbox" name="set-external-id" class="input" />Задать (не генерировать)</label>
                                    <input type="text" id="generate-key-id" value="AA:BB:CC:DD" class="input"/>
                                </li>
                                <li>
                                    <label for="generate-key-marker">Маркер ключа:</label>
                                    <input type="text" id="generate-key-marker" value="BusinessTests" class="input"/>
                                </li>
                                <li>
                                    <label><input type="checkbox" name="journal" class="input" />Создать журнальную ключевую пару</label>
                                </li>
                                <li>
                                    <select class="public-key-algorithm">
                                        <option value="PUBLIC_KEY_ALGORITHM_GOST3410_2001">ГОСТ Р 34.10-2001</option>
                                        <option value="PUBLIC_KEY_ALGORITHM_GOST3410_2012_256">ГОСТ Р 34.10-2012 256</option>
                                        <option value="PUBLIC_KEY_ALGORITHM_GOST3410_2012_512">ГОСТ Р 34.10-2012 512</option>
                                        <option value="PUBLIC_KEY_ALGORITHM_RSA">RSA</option>
                                    </select>
                                </li>
                                <li>
                                    <label for="rsa-keygen-size">Размер RSA ключа:</label>
                                    <select id="rsa-keygen-size" class="rsa-keygen-size" disabled=true>
                                        <option value="512">512</option>
                                        <option value="768">768</option>
                                        <option value="1024">1024</option>
                                        <option value="1280">1280</option>
                                        <option value="1536">1536</option>
                                        <option value="1792">1792</option>
                                        <option value="2048" selected>2048</option>
                                        <option value="4096">4096</option>
                                    </select>
                                </li>
                            </ul>
                        </div>
                        <div id="EnumerateKeys" class="group">
                            <ul>
                                <li>
                                    <label for="enumerate-key-marker" class="temp">Маркер ключевой пары:</label>
                                    <input type="text" id="enumerate-key-marker" value="BusinessTests" class="input"/>
                                </li>
                            </ul>
                        </div>
                        <div id="SetKeyLabel" class="group">
                            <ul>
                                <li>
                                    <label for="key-label" class="temp">Метка ключевой пары:</label>
                                    <input type="text" id="key-label" value="test key" class="input"/>
                                </li>
                            </ul>
                        </div>
                        <div id="GetKeyLabel" class="group"></div>
                        <div id="GetPublicKey" class="group"></div>
                        <div id="GetKeyInfo" class="group">
                            <ul>
                                <li>
                                    <label for="key-info-radio">Тип информации:</label><br>
                                    <label><input class="radio-input" type="radio" name="key-info" value="algorithm" checked="checked"/>Алгоритм</label>
                                </li>
                            </ul>
                        </div>
                        <div id="DeleteKeyPair" class="group"></div>
                        <div id="GetJournal" class="group">
                            <ul>
                                <li>
                                    <textarea id="get-journal-result" class="text-output" rows="7"></textarea>
                                </li>
                            </ul>
                        </div>
                        <div id="getLicence" class="group">
                            <ul>
                                <li>
                                    <label>Идентификатор лицензии:</label>
                                    <select class="licence-id">
                                        <option value=1>Лицензия 1</option>
                                        <option value=2>Лицензия 2</option>
                                    </select>
                                </li>
                            </ul>
                        </div>
                        <div id="setLicence" class="group">
                            <ul>
                                <li>
                                    <label>Идентификатор лицензии:</label>
                                    <select class="licence-id">
                                        <option value=1>Лицензия 1</option>
                                        <option value=2>Лицензия 2</option>
                                    </select>
                                    <textarea id="set-licence" class="text-input" rows="7">00:01:02:03:04:05:06:07:08:09:10:11:12:13:14:15:16:17:18:19:20:21:22:23:24:25:26:27:28:29:30:31:32:33:34:35:36:37:38:39:40:41:42:43:44:45:46:47:48:49:50:51:52:53:54:55:56:57:58:59:60:61:62:63:64:65:66:67:68:69:70:71</textarea>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div id="section-2">
                        <div id="CreatePkcs10" class="group">
                            <ul>
                                <li>
                                    <label>subjectSignTool:</label>
                                    <input type="text" class="subject-sign-tool input" value='СКЗИ "РУТОКЕН ЭЦП"' />
                                    <label>Алгоритм хэширования:</label>
                                    <select class="hash-algorithm">
                                        <option value="HASH_TYPE_GOST3411_94">ГОСТ Р 34.11-94</option>
                                        <option value="HASH_TYPE_GOST3411_12_256">ГОСТ Р 34.11-12 256</option>
                                        <option value="HASH_TYPE_GOST3411_12_512">ГОСТ Р 34.11-12 512</option>
                                        <option value="HASH_TYPE_MD5">MD5</option>
                                        <option value="HASH_TYPE_SHA1">SHA1</option>
                                        <option value="HASH_TYPE_SHA256">SHA256</option>
                                        <option value="HASH_TYPE_SHA512">SHA512</option>
                                    </select>
                                </li>
                                <li id="cert-subject">
                                    <table>
                                        <tr>
                                            <th><label>countryName</label></th>
                                            <td><input type="text" id="countryName" value="RU" class="subject-input"/></td>
                                            <th><label>stateOrProvinceName</label></th>
                                            <td><input type="text" id="stateOrProvinceName" value="Moscow" class="subject-input"/></td>
                                        </tr>
                                        <tr>
                                            <th><label>localityName</label></th>
                                            <td><input type="text" id="localityName" value="msk" class="subject-input"/></td>
                                            <th><label>streetAddress</label></th>
                                            <td><input type="text" id="streetAddress" value="street" class="subject-input"/></td>
                                        </tr>
                                        <tr>
                                            <th><label>organizationName</label></th>
                                            <td><input type="text" id="organizationName" value="Aktiv" class="subject-input"/></td>
                                            <th><label>organizationalUnitName</label></th>
                                            <td><input type="text" id="organizationalUnitName" value="IT" class="subject-input"/></td>
                                        </tr>
                                        <tr>
                                            <th><label>postalAddress</label></th>
                                            <td><input type="text" id="postalAddress" value="postal address" class="subject-input"/></td>
                                            <th><label>title</label></th>
                                            <td><input type="text" id="title" value="должность" class="subject-input"/></td>
                                        </tr>
                                        <tr>
                                            <th><label>INN</label></th>
                                            <td><input type="text" id="INN" value="12345678987" class="subject-input"/></td>
                                            <th><label>SNILS</label></th>
                                            <td><input type="text" id="SNILS" value="12345678987" class="subject-input"/></td>
                                        </tr>
                                        <tr>
                                            <th><label>OGRN</label></th>
                                            <td><input type="text" id="OGRN" value="12345678987" class="subject-input"/></td>
                                            <th><label>OGRNIP</label></th>
                                            <td><input type="text" id="OGRNIP" value="12345678987" class="subject-input"/></td>
                                        </tr>
                                        <tr>
                                            <th><label>commonName</label></th>
                                            <td><input type="text" id="commonName" value="Фамилия Имя Отчество" class="subject-input"/></td>
                                            <th><label>pseudonym</label></th>
                                            <td><input type="text" id="pseudonym" value="pseudonym" class="subject-input"/></td>
                                        </tr>
                                        <tr>
                                            <th><label>surname</label></th>
                                            <td><input type="text" id="surname" value="surname" class="subject-input"/></td>
                                            <th><label>givenName</label></th>
                                            <td><input type="text" id="givenName" value="given name" class="subject-input"/></td>
                                        </tr>
                                        <tr>
                                            <th><label>emailAddress</label></th>
                                            <td><input type="text" id="emailAddress" value="example@example.com" class="subject-input"/></td>
                                            <th></th>
                                            <td></td>
                                        </tr>
                                    </table>
                                </li>
                                <li>
                                    <table id="cert-extensions" class="inlineblock">
                                        <tr>
                                            <th>Key Usage</th>
                                            <th>Ext Key Usage</th>
                                            <th>Policies</th>
                                        </tr>
                                        <tr>
                                            <td><label><input class="checkbox-input" type="checkbox" name="cert-exts-keyusage" value="digitalSignature" checked="checked"/>digitalSignature</label></td>
                                            <td><label><input class="checkbox-input" type="checkbox" name="cert-exts-extkeyusage" value="emailProtection" checked="checked"/>emailProtection</label></td>
                                            <td><label><input class="checkbox-input" type="checkbox" name="cert-exts-policies" value="1.2.643.100.113.1" checked="checked"/>КС1</label></td>
                                        </tr>
                                        <tr>
                                            <td><label><input class="checkbox-input" type="checkbox" name="cert-exts-keyusage" value="nonRepudiation" checked="checked"/>nonRepudiation</label></td>
                                            <td><label><input class="checkbox-input" type="checkbox" name="cert-exts-extkeyusage" value="clientAuth" />clientAuth</label></td>
                                            <td><label><input class="checkbox-input" type="checkbox" name="cert-exts-policies" value="1.2.643.100.113.2"/>КС2</label></td>
                                        </tr>
                                        <tr>
                                            <td><label><input class="checkbox-input" type="checkbox" name="cert-exts-keyusage" value="keyEncipherment"/>keyEncipherment</label></td>
                                            <td><label><input class="checkbox-input" type="checkbox" name="cert-exts-extkeyusage" value="serverAuth" />serverAuth</label></td>
                                            <td><label><input class="checkbox-input" type="checkbox" name="cert-exts-policies" value="1.2.643.100.113.3"/>КС3</label></td>
                                        </tr>
                                        <tr>
                                            <td><label><input class="checkbox-input" type="checkbox" name="cert-exts-keyusage" value="dataEncipherment" />dataEncipherment</label></td>
                                            <td><label><input class="checkbox-input" type="checkbox" name="cert-exts-extkeyusage" value="codeSigning" />codeSigning</label></td>
                                            <td><label><input class="checkbox-input" type="checkbox" name="cert-exts-policies" value="1.2.643.100.113.4"/>КВ1</label></td>
                                        </tr>
                                        <tr>
                                            <td><label><input class="checkbox-input" type="checkbox" name="cert-exts-keyusage" value="keyAgreement"/>keyAgreement</label></td>
                                            <td><label><input class="checkbox-input" type="checkbox" name="cert-exts-extkeyusage" value="timeStamping" />timeStamping</label></td>
                                            <td><label><input class="checkbox-input" type="checkbox" name="cert-exts-policies" value="1.2.643.100.113.5"/>КВ2</label></td>
                                        </tr>
                                        <tr>
                                            <td><label><input class="checkbox-input" type="checkbox" name="cert-exts-keyusage" value="keyCertSign"/>keyCertSign</label></td>
                                            <td><label><input class="checkbox-input" type="checkbox" name="cert-exts-extkeyusage" value="msCodeInd" />msCodeInd</label></td>
                                            <td><label><input class="checkbox-input" type="checkbox" name="cert-exts-policies" value="1.2.643.100.113.6"/>КА1</label></td>
                                        </tr>
                                        <tr>
                                            <td><label><input class="checkbox-input" type="checkbox" name="cert-exts-keyusage" value="cRLSign"/>cRLSign</label></td>
                                            <td><label><input class="checkbox-input" type="checkbox" name="cert-exts-extkeyusage" value="msCodeCom" />msCodeCom</label></td>
                                        </tr>
                                        <tr>
                                            <td><label><input class="checkbox-input" type="checkbox" name="cert-exts-keyusage" value="encipherOnly"/>encipherOnly</label></td>
                                            <td><label><input class="checkbox-input" type="checkbox" name="cert-exts-extkeyusage" value="msCTLSign" />msCTLSign</label></td>
                                        </tr>
                                        <tr>
                                            <td><label><input class="checkbox-input" type="checkbox" name="cert-exts-keyusage" value="decipherOnly"/>decipherOnly</label></td>
                                            <td><label><input class="checkbox-input" type="checkbox" name="cert-exts-extkeyusage" value="1.3.6.1.5.5.7.3.9" />OCSP</label></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td><label><input class="checkbox-input" type="checkbox" name="cert-exts-extkeyusage" value="1.2.643.2.2.34.6" />CryptoPro RA user</label></td>
                                        </tr>
                                    </table>
                                    <table id="custom-extensions" class="inlineblock">
                                        <tr>
                                            <th colspan="2">Custom Extensions</th>
                                        </tr>
                                        <tr>
                                            <td><label>OID</label></td>
                                            <td><input type="text" value="1.3.6.1.4.1.311.21.7" name="custom-ext-oid"></td>
                                        </tr>
                                        <tr>
                                            <td><label>value</label></td>
                                            <td><input type="text" value="MA0GCCqFAwICLgAIAgEB" name="custom-ext-value"></td>
                                        </tr>
                                        <tr>
                                            <td><label><input class="checkbox-input" type="checkbox" name="custom-ext-crit">Critical</label></td>
                                            <td><label style="color: grey;">value должен быть в base64</label></td>
                                        </tr>
                                        <tr>
                                            <td colspan="2"><button id="add-custom-extension" class="example">Добавить новое расширение</button></td>
                                        </tr>
                                    </table>
                                </li>
                                <li>
                                    <textarea id="create-pkcs10-result" class="text-output" rows="7"></textarea>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div id="section-3">
                        <div id="ImportCertificate" class="group">
                            <ul>
                                <li class='bottom'>
                                    <label for="import-cert-body">Cертификат в формате PEM</label>
                                    <textarea id="import-cert-body" class="text-input" rows="7">-----BEGIN CERTIFICATE-----&#10;MIIE9DCCBKOgAwIBAgIKGeFWzQACAAJYxzAIBgYqhQMCAgMwZTEgMB4GCSqGSIb3&#10;DQEJARYRaW5mb0BjcnlwdG9wcm8ucnUxCzAJBgNVBAYTAlJVMRMwEQYDVQQKEwpD&#10;UllQVE8tUFJPMR8wHQYDVQQDExZUZXN0IENlbnRlciBDUllQVE8tUFJPMB4XDTEy&#10;MDgxNjEyNDgxMFoXDTE0MTAwNDA3MDk0MVowggGKMQswCQYDVQQGEwJSVTEPMA0G&#10;A1UECBMGbW9zY293MREwDwYDVQQHEwhsb2NhbGl0eTEPMA0GA1UECRMGc3RyZWV0&#10;MQ4wDAYDVQQKEwVBa3RpdjELMAkGA1UECxMCSVQxGzAZBgNVBAweEgQ0BD4EOwQ2&#10;BD0EPgRBBEIETDEZMBcGCCqFAwOBAwEBEgsxMjM0MjM1MzQ1MjEWMBQGBSqFA2QD&#10;EgsxMjM0MjM1MzQ1MjEWMBQGBSqFA2QBEgsxMjM0MjM1MzQ1MjEWMBQGBSqFA2QF&#10;EgsxMjM0MjM1MzQ1MjEvMC0GA1UEAx4mBCQEMAQ8BDgEOwQ4BE8AIAQYBDwETwAg&#10;BB4ERwQ1BEEEQgQyBD4xFzAVBgNVBBATDnBvc3RhbCBhZGRyZXNzMRQwEgYDVQRB&#10;Ewtwc2V1ZG9ueW11czEQMA4GA1UEBBMHc3VybmFtZTETMBEGA1UEKhMKZ2l2ZW4g&#10;bmFtZTEiMCAGCSqGSIb3DQEJARYTZXhhbXBsZUBleGFtcGxlLmNvbTBjMBwGBiqF&#10;AwICEzASBgcqhQMCAiMBBgcqhQMCAh4BA0MABEC8dyMzXuEbYHV9NwCWZQmoWmon&#10;xJAfFTMtoKfuWWwhNg3ZuL36UP/zjTd33HolBNkRIC0FgtxpfQ+ES3l3J7PVo4IC&#10;CjCCAgYwDAYDVR0PBAUDAwf3gDB1BgNVHSUBAf8EazBpBggrBgEFBQcDBAYIKwYB&#10;BQUHAwIGCCsGAQUFBwMBBggrBgEFBQcDAwYIKwYBBQUHAwgGCisGAQQBgjcCARUG&#10;CisGAQQBgjcCARYGCisGAQQBgjcKAwEGCCsGAQUFBwMJBgcqhQMCAiIGMEUGA1Ud&#10;IAQ+MDwwCAYGKoUDZHEBMAgGBiqFA2RxAjAIBgYqhQNkcQMwCAYGKoUDZHEEMAgG&#10;BiqFA2RxBTAIBgYqhQNkcQYwHQYDVR0OBBYEFB1Iacp18c1KccWyrbNYHhmTc0Ly&#10;MB8GA1UdIwQYMBaAFG2PXgXZX6yRF5QelZoFMDg3ehAqMFUGA1UdHwROMEwwSqBI&#10;oEaGRGh0dHA6Ly93d3cuY3J5cHRvcHJvLnJ1L0NlcnRFbnJvbGwvVGVzdCUyMENl&#10;bnRlciUyMENSWVBUTy1QUk8oMikuY3JsMIGgBggrBgEFBQcBAQSBkzCBkDAzBggr&#10;BgEFBQcwAYYnaHR0cDovL3d3dy5jcnlwdG9wcm8ucnUvb2NzcG5jL29jc3Auc3Jm&#10;MFkGCCsGAQUFBzAChk1odHRwOi8vd3d3LmNyeXB0b3Byby5ydS9DZXJ0RW5yb2xs&#10;L3BraS1zaXRlX1Rlc3QlMjBDZW50ZXIlMjBDUllQVE8tUFJPKDIpLmNydDAIBgYq&#10;hQMCAgMDQQAN/R7GwKALwybssbX1FnfHqZxvIxh13Pu2+iLgK/cRGQ9Ga9i8d6+0&#10;E4wUHty12HGB0ABPrQ43QmTGeNocDz/h&#10;-----END CERTIFICATE-----</textarea>
                                </li>
                                   <li>Категория сертификата:</li>
                                <li>
                                    <label><input type="radio" class="radio-input" name="certificate-category" value="user" checked="checked"/>Пользовательский</label> <br>
                                    <label><input type="radio" class="radio-input" name="certificate-category" value="ca"/>Корневой</label> <br>
                                    <label><input type="radio" class="radio-input" name="certificate-category" value="other"/>Другой</label>
                                </li>
                            </ul>
                        </div>
                        <div id="DeleteCertificate" class="group"></div>
                        <div id="GetCertificate" class="group">
                            <ul>
                                <li><textarea id="get-cert-result" class="text-output" rows="7"></textarea></li>
                            </ul>
                        </div>
                        <div id="ParseCertificate" class="group">
                            <ul>
                                <li><textarea id="parse-cert-result" class="text-output" rows="7"></textarea></li>
                            </ul>
                        </div>
                        <div id="ParseCertificateFromString" class="group">
                            <ul>
                                <li>
                                <label for="parse-cert-string-body">Cертификат в формате PEM:</label>
                                <textarea id="parse-cert-string-body" class="text-input" rows="7">-----BEGIN CERTIFICATE-----&#10;MIIE9DCCBKOgAwIBAgIKGeFWzQACAAJYxzAIBgYqhQMCAgMwZTEgMB4GCSqGSIb3&#10;DQEJARYRaW5mb0BjcnlwdG9wcm8ucnUxCzAJBgNVBAYTAlJVMRMwEQYDVQQKEwpD&#10;UllQVE8tUFJPMR8wHQYDVQQDExZUZXN0IENlbnRlciBDUllQVE8tUFJPMB4XDTEy&#10;MDgxNjEyNDgxMFoXDTE0MTAwNDA3MDk0MVowggGKMQswCQYDVQQGEwJSVTEPMA0G&#10;A1UECBMGbW9zY293MREwDwYDVQQHEwhsb2NhbGl0eTEPMA0GA1UECRMGc3RyZWV0&#10;MQ4wDAYDVQQKEwVBa3RpdjELMAkGA1UECxMCSVQxGzAZBgNVBAweEgQ0BD4EOwQ2&#10;BD0EPgRBBEIETDEZMBcGCCqFAwOBAwEBEgsxMjM0MjM1MzQ1MjEWMBQGBSqFA2QD&#10;EgsxMjM0MjM1MzQ1MjEWMBQGBSqFA2QBEgsxMjM0MjM1MzQ1MjEWMBQGBSqFA2QF&#10;EgsxMjM0MjM1MzQ1MjEvMC0GA1UEAx4mBCQEMAQ8BDgEOwQ4BE8AIAQYBDwETwAg&#10;BB4ERwQ1BEEEQgQyBD4xFzAVBgNVBBATDnBvc3RhbCBhZGRyZXNzMRQwEgYDVQRB&#10;Ewtwc2V1ZG9ueW11czEQMA4GA1UEBBMHc3VybmFtZTETMBEGA1UEKhMKZ2l2ZW4g&#10;bmFtZTEiMCAGCSqGSIb3DQEJARYTZXhhbXBsZUBleGFtcGxlLmNvbTBjMBwGBiqF&#10;AwICEzASBgcqhQMCAiMBBgcqhQMCAh4BA0MABEC8dyMzXuEbYHV9NwCWZQmoWmon&#10;xJAfFTMtoKfuWWwhNg3ZuL36UP/zjTd33HolBNkRIC0FgtxpfQ+ES3l3J7PVo4IC&#10;CjCCAgYwDAYDVR0PBAUDAwf3gDB1BgNVHSUBAf8EazBpBggrBgEFBQcDBAYIKwYB&#10;BQUHAwIGCCsGAQUFBwMBBggrBgEFBQcDAwYIKwYBBQUHAwgGCisGAQQBgjcCARUG&#10;CisGAQQBgjcCARYGCisGAQQBgjcKAwEGCCsGAQUFBwMJBgcqhQMCAiIGMEUGA1Ud&#10;IAQ+MDwwCAYGKoUDZHEBMAgGBiqFA2RxAjAIBgYqhQNkcQMwCAYGKoUDZHEEMAgG&#10;BiqFA2RxBTAIBgYqhQNkcQYwHQYDVR0OBBYEFB1Iacp18c1KccWyrbNYHhmTc0Ly&#10;MB8GA1UdIwQYMBaAFG2PXgXZX6yRF5QelZoFMDg3ehAqMFUGA1UdHwROMEwwSqBI&#10;oEaGRGh0dHA6Ly93d3cuY3J5cHRvcHJvLnJ1L0NlcnRFbnJvbGwvVGVzdCUyMENl&#10;bnRlciUyMENSWVBUTy1QUk8oMikuY3JsMIGgBggrBgEFBQcBAQSBkzCBkDAzBggr&#10;BgEFBQcwAYYnaHR0cDovL3d3dy5jcnlwdG9wcm8ucnUvb2NzcG5jL29jc3Auc3Jm&#10;MFkGCCsGAQUFBzAChk1odHRwOi8vd3d3LmNyeXB0b3Byby5ydS9DZXJ0RW5yb2xs&#10;L3BraS1zaXRlX1Rlc3QlMjBDZW50ZXIlMjBDUllQVE8tUFJPKDIpLmNydDAIBgYq&#10;hQMCAgMDQQAN/R7GwKALwybssbX1FnfHqZxvIxh13Pu2+iLgK/cRGQ9Ga9i8d6+0&#10;E4wUHty12HGB0ABPrQ43QmTGeNocDz/h&#10;-----END CERTIFICATE-----</textarea>
                                </li>
                                <li><textarea id="parse-cert-string-result" class="text-output" rows="7"></textarea></li>
                            </ul>
                        </div>
                        <div id="GetKeyByCertificate" class="group"></div>
                        <div id="GetCertificateInfo" class="group">
                            <ul>
                                <li>
                                    <label for="cert-info-radio">Тип информации:</label><br>
                                    <label><input class="radio-input" type="radio" name="certificate-info" value="serial number" checked="checked"/>Серийный номер</label>
                                </li>
                            </ul>
                        </div>

                        <div class="common">
                            <dl>
                                <dt><label for="system-store-cert-list">Сертификаты в хранилище: </label></dt>
                                <dd>
                                    <select id="system-store-cert-list">
                                        <option>Обновите список сертификатов</option>
                                    </select>
                                    <button id="refresh-system-store-certs">↓↑</button>
                                </dd>
                            </dl>
                        </div>

                        <div id="GetStoreCertificate" class="group">
                            <ul>
                                <li><textarea id="get-store-cert-result" class="text-output" rows="7"></textarea></li>
                            </ul>
                        </div>

                    </div>
                    <div id="section-4">
                        <div id="SignMessage" class="group">
                            <ul>
                                <li>
                                    <label for="sign-message">Сообщение. Должно быть пусто при добавлении подписи в attached cms</label>
                                    <textarea id="sign-message" class="text-input" rows="7">Текст очень важного платежного документа</textarea>
                                </li>
                                <li>
                                    <label for="sign-message-cms">Сформированный CMS (для добавления подписи). Должно быть пусто при формировании подписи данных</label>
                                    <textarea id="sign-message-cms" class="text-input" rows="7"></textarea>
                                </li>
                                <li>
                                    <label><input type="checkbox" name="use-hw-hash" />Вычислять хеш на устройстве (необходимо если на ключе установлен атрибут подтверждения операции)</label><br>
                                    <label><input type="checkbox" name="detached-sign" />Создавать отсоединенную подпись</label><br>
                                    <label><input type="checkbox" name="add-user-cert" checked="checked"/>Включать сертификат пользователя</label><br>
                                    <label><input type="checkbox" name="add-sign-time" id="add-sign-time" checked="checked"/>Добавить timestamp</label><br>
                                    <label><input type="checkbox" name="rsa-hash" id="cms-rsa-hash"/>Алгоритм хэширования для RSA ключей</label>
                                    <select class="hash-alg" id="cms-hash-alg" disabled=true>
                                        <option value="HASH_TYPE_MD5">MD5</option>
                                        <option value="HASH_TYPE_SHA1">SHA1</option>
                                        <option value="HASH_TYPE_SHA256">SHA256</option>
                                        <option value="HASH_TYPE_SHA512">SHA512</option>
                                    </select><br>
                                    <label>Формат сообщения:</label>
                                    <select class="data-format">
                                        <option value="DATA_FORMAT_PLAIN">Строка</option>
                                        <option value="DATA_FORMAT_BASE64">Base64</option>
                                        <option value="DATA_FORMAT_HASH">Хеш сообщения (hex)</option>
                                    </select><br>
                                    <label><input type="checkbox" name="set-content-type" id="set-content-type"/>Задать eContentType:</label>
                                    <input type="text" class="set-content-type" value="1.3.6.1.5.5.7.12.2"/>
                                    <label><input type="checkbox" name="add-system-info" id="add-system-info"/>Включать информацию о месте подписи</label>
                                    <label><input type="checkbox" name="add-security-products-info" id="add-security-products-info"/>Включить информацию о продуктах безопасности</label>
                                </li>
                                <li>
                                    <textarea id="sign-message-result" class="text-output" rows="7"></textarea>
                                </li>
                            </ul>
                        </div>
                        <div id="CmcRequest" class="group">
                            <ul>
                                <li>
                                    <label for="pkcs10-for-cmc">PKCS #10 запрос на ГОСТ ключах</label>
                                    <textarea id="pkcs10-for-cmc" class="text-input" rows="7">-----BEGIN CERTIFICATE REQUEST-----
MIICRzCCAfICAQAwggECMQswCQYDVQQGEwJSVTEPMA0GA1UECAwGTW9zY293MQww
CgYDVQQHDANtc2sxDzANBgNVBAkMBnN0cmVldDEOMAwGA1UECgwFQWt0aXYxCzAJ
BgNVBAsMAklUMRcwFQYDVQQQDA5wb3N0YWwgYWRkcmVzczEbMBkGA1UEDAwS0LTQ
vtC70LbQvdC+0YHRgtGMMREwDwYDVQQDDAhJbmZvdGVjczESMBAGA1UEQQwJcHNl
dWRvbnltMRAwDgYDVQQEDAdzdXJuYW1lMRMwEQYDVQQqDApnaXZlbiBuYW1lMSIw
IAYJKoZIhvcNAQkBFhNleGFtcGxlQGV4YW1wbGUuY29tMGYwHwYIKoUDBwEBAQEw
EwYHKoUDAgIjAQYIKoUDBwEBAgIDQwAEQOlyPFiRCUVmaBEEnj6899r4vrsop5UI
4ZqzZhKJP6AIWG5KQiKOXBs7ctlw0feKLDEZn4Mn7y3tc/yQ4mg1y6qgfzB9Bgkq
hkiG9w0BCQ4xcDBuMAsGA1UdDwQEAwIGwDAdBgNVHSUEFjAUBggrBgEFBQcDBAYI
KwYBBQUHAwgwEwYDVR0gBAwwCjAIBgYqhQNkcQEwKwYFKoUDZG8EIgwg0KHQmtCX
0JggItCg0KPQotCe0JrQldCdINCt0KbQnyIwDAYIKoUDBwEBAwIFAANBAB1/Hrjo
TlQJZpgJL+Id9X0r5JodS/0jD+zk5qllNg3IlKIUKWmA38KRucnEne6OgZMwoso0
IPx1wd5hBhGV714=
-----END CERTIFICATE REQUEST-----</textarea>
                                </li>
                                <li>
                                    <textarea id="cmc-request-result" placeholder="Подписанный на текущем сертификате CMC запрос" class="text-output" rows="7"></textarea>
                                </li>
                            </ul>
                        </div>
                        <div id="CalcHash" class="group">
                            <ul>
                                <li>
                                    <label for="calc-hash">Хеш</label>
                                    <textarea id="calc-hash" class="text-input" rows="7">Текст для вычисления хеша</textarea>
                                </li>
                                <li>
                                    <label><input type="checkbox" name="use-hw-hash" />Вычислять хеш на устройстве</label><br>
                                    <label><input type="checkbox" name="in-base64" />Данные в base64</label>
                                </li>
                                <li>
                                    <label for="hash-type">Алгоритм хеширования:</label>
                                    <select class="hash-algorithm">
                                        <option value="HASH_TYPE_GOST3411_94">ГОСТ Р 34.11-94</option>
                                        <option value="HASH_TYPE_GOST3411_12_256">ГОСТ Р 34.11-12 256</option>
                                        <option value="HASH_TYPE_GOST3411_12_512">ГОСТ Р 34.11-12 512</option>
                                    </select>
                                </li>
                                <li>
                                    <textarea id="hash-message-result" class="text-output" rows="7"></textarea>
                                </li>
                            </ul>
                        </div>
                        <div id="SignHash" class="group">
                            <ul>
                                <li>
                                    <label for="sign-hash">Хеш (размер должен соответствовать алгоритму хеширования)</label>
                                    <textarea id="sign-hash" class="text-input" rows="7">01:23:45:67:89:ab:cd:ef:01:23:45:67:89:ab:cd:ef:01:23:45:67:89:ab:cd:ef:01:23:45:67:89:ab:cd:ef</textarea>
                                </li>
                                <li>
                                    <label><input type="checkbox" name="compute-hash" />Предварительно хешировать данные</label><br>
                                    <label><input type="checkbox" name="use-hw-hash" />Вычислять хеш на устройстве</label>
                                </li>
                                <li>
                                    <label>Алгоритм хеширования:</label>
                                    <select class="hash-algorithm">
                                        <option value="HASH_TYPE_GOST3411_94">ГОСТ Р 34.11-94</option>
                                        <option value="HASH_TYPE_GOST3411_12_256">ГОСТ Р 34.11-12 256</option>
                                        <option value="HASH_TYPE_GOST3411_12_512">ГОСТ Р 34.11-12 512</option>
                                        <option value="HASH_TYPE_MD5">MD5</option>
                                        <option value="HASH_TYPE_SHA1">SHA1</option>
                                        <option value="HASH_TYPE_SHA256">SHA256</option>
                                        <option value="HASH_TYPE_SHA512">SHA512</option>
                                    </select>
                                </li>
                                <li>
                                    <textarea id="sign-message-result" class="text-output" rows="7"></textarea>
                                </li>
                            </ul>
                        </div>
                        <div id="DeriveKey" class="group">
                            <ul>
                                <li>
                                    <label for="public-key">Открытый ключ (размер и значение должно согласовываться с закрытым ключом)</label>
                                    <textarea id="public-key" class="text-input" rows="4">3d:3f:96:3e:31:98:34:ee:7a:1a:c4:f5:a2:78:a7:8c:30:00:b4:15:8b:12:64:77:00:95:5d:06:3b:47:a6:a9:d3:35:79:17:4f:22:7f:8a:4d:e6:1c:d6:79:45:93:8e:36:ee:0d:d5:0c:1a:da:1e:03:a1:ff:9c:d4:b4:78:4d</textarea>
                                    <label for="ukm">Синхропосылка (8 байт)</label>
                                    <textarea id="ukm" class="text-input" rows="1">01:02:03:04:05:06:07:08</textarea>
                                </li>
                                <li>
                                    <textarea id="derive-result" class="text-output" rows="7"></textarea>
                                </li>
                            </ul>
                        </div>
                        <div id="SignMessageSafeTouch" class="group">
                            <ul>
                                <li>
                                    <label for="sign-message">Сообщение. Должно быть пусто при добавлении подписи в attached cms</label>
                                    <textarea id="sign-message" class="text-input" rows="7">AQACNTUCAAEBgQAJMDQwNDA0MDQwggAKNzcwMTAwMTAwMYMADVNhZmVUZWNoIEx0ZC6EABQ0MDgxNzgxMDg5NzYyMDAwMDAwMIUACjk5OTk5OTk5OTmGAANSVUL/AA0wMDAwMDAwMDAwMDAw</textarea>
                                </li>
                                <li>
                                    <label for="sign-message-cms">Сформированный CMS (для добавления подписи). Должно быть пусто при формировании подписи данных</label>
                                    <textarea id="sign-message-cms" class="text-input" rows="7"></textarea>
                                </li>
                                <li>
                                    <label><input type="checkbox" name="detached-sign" />Создавать отсоединенную подпись</label><br/>
                                    <label><input type="checkbox" name="in-base64"/>Данные в base64</label><br>
                                    <label><input type="checkbox" name="add-user-cert" checked="checked"/>Включать сертификат пользователя</label>
                                </li>
                                <li>
                                    <textarea id="sign-message-result" class="text-output" rows="7"></textarea>
                                </li>
                            </ul>
                        </div>
                        <div id="Authenticate" class="group">
                            <ul>
                                <li>
                                    <label for="authenticate">Собщение от сервера</label>
                                    <textarea id="authenticate" class="text-input" rows="7">Выполнить аутентификацию? Случайные данные от сервера: </textarea>
                                </li>
                                <li>
                                    <textarea id="authenticate-result" class="text-output" rows="7"></textarea>
                                </li>
                            </ul>
                        </div>
                        <div id="Verify" class="group">
                            <ul>
                                <li>
                                    <label for="sign">Подпись в формате CMS</label>
                                    <textarea placeholder="Введите CMS" id="sign" class="text-input" rows="7"></textarea>
                                </li>
                                <li>
                                    <label><input type="checkbox" name="use-hw-hash" />Вычислять хеш на устройстве</label><br>
                                    <label><input type="checkbox" checked="checked" name="verify-signer-cert" />Проверять сертификат</label><br>
                                    <label><input type="checkbox" name="in-base64"/>Данные в base64</label>
                                </li>
                                <li>
                                    <label for="data">Подписанные данные</label>
                                    <textarea placeholder="Опционально - в случае если проверяется detached подпись" id="data" class="text-input" rows="7"></textarea>
                                </li>
                                <li>
                                    <table id="Certificates" class="inlineblock">
                                        <tr>
                                            <td colspan="2">
                                                <label for="cert">Сертификат</label>
                                                <textarea placeholder="Опционально - в случае если он не включен в cms" id="cert" class="verify-signer"></textarea>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2"><button id="verify-add-signer" class="example">Добавить еще</button></td>
                                        </tr>
                                    </table>
                                </li>
                                <li>
                                    <label for="ca-cert">СА</label>
                                    <textarea placeholder="СА" id="ca-cert" class="text-input" rows="7"></textarea>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div id="section-5">
                        <div id="EncryptMessage" class="group">
                            <ul id="EncryptMessageUl">
                                <li>
                                    <table id="Recipients" class="inlineblock">
                                        <tr>
                                            <th colspan="2">Получатели</th>
                                        </tr>
                                        <tr>
                                            <td colspan="2">
                                                <label for="encrypt-certificate">Тело сертификата</label>
                                                <textarea id="encrypt-certificate" class="recipient" rows="7">-----BEGIN CERTIFICATE-----&#10;MIIEWzCCBAqgAwIBAgIKfFP2xQACAALbSzAIBgYqhQMCAgMwZTEgMB4GCSqGSIb3DQEJARYRaW5mb0BjcnlwdG9wcm8ucnUxCzAJBgNVBAYTAlJVMRMwEQYDVQQKEwpDUllQVE8tUFJPMR8wHQYDVQQDExZUZXN0IENlbnRlciBDUllQVE8tUFJPMB4XDTEyMTAzMTEyMjIyNloXDTE0MTAwNDA3MDk0MVowggGDMQswCQYDVQQGEwJSVTEPMA0GA1UECBMGTW9zY293MQwwCgYDVQQHEwNtc2sxDzANBgNVBAkTBnN0cmVldDEOMAwGA1UEChMFQWt0aXYxCzAJBgNVBAsTAklUMRcwFQYDVQQQEw5wb3N0YWwgYWRkcmVzczEbMBkGA1UEDB4SBDQEPgQ7BDYEPQQ+BEEEQgRMMRkwFwYIKoUDA4EDAQESCzEyMzQ1Njc4OTg3MRYwFAYFKoUDZAMSCzEyMzQ1Njc4OTg3MRYwFAYFKoUDZAESCzEyMzQ1Njc4OTg3MRYwFAYFKoUDZAUSCzEyMzQ1Njc4OTg3MS8wLQYDVQQDHiYEJAQwBDwEOAQ7BDgETwAgBBgEPARPACAEHgRHBDUEQQRCBDIEPjESMBAGA1UEQRMJcHNldWRvbnltMRAwDgYDVQQEEwdzdXJuYW1lMRMwEQYDVQQqEwpnaXZlbiBuYW1lMSIwIAYJKoZIhvcNAQkBFhNleGFtcGxlQGV4YW1wbGUuY29tMGMwHAYGKoUDAgITMBIGByqFAwICIwEGByqFAwICHgEDQwAEQAhY4OcPvPJanf/8RhuIh3jt3MAOgtHwJSspvQwPi0SUNU4wILT1M9//WlAAz4hEXqx+9pGfyUiYsg/bgKwLsmWjggF4MIIBdDALBgNVHQ8EBAMCBsAwFgYDVR0lAQH/BAwwCgYIKwYBBQUHAwQwEwYDVR0gBAwwCjAIBgYqhQNkcQEwHQYDVR0OBBYEFOxa5YWf5fGZiFQew1lp0FyhfrogMB8GA1UdIwQYMBaAFG2PXgXZX6yRF5QelZoFMDg3ehAqMFUGA1UdHwROMEwwSqBIoEaGRGh0dHA6Ly93d3cuY3J5cHRvcHJvLnJ1L0NlcnRFbnJvbGwvVGVzdCUyMENlbnRlciUyMENSWVBUTy1QUk8oMikuY3JsMIGgBggrBgEFBQcBAQSBkzCBkDAzBggrBgEFBQcwAYYnaHR0cDovL3d3dy5jcnlwdG9wcm8ucnUvb2NzcG5jL29jc3Auc3JmMFkGCCsGAQUFBzAChk1odHRwOi8vd3d3LmNyeXB0b3Byby5ydS9DZXJ0RW5yb2xsL3BraS1zaXRlX1Rlc3QlMjBDZW50ZXIlMjBDUllQVE8tUFJPKDIpLmNydDAIBgYqhQMCAgMDQQAuWkeHdQran99h1XeLuepMQA9FIf4PwMzgwCi3bs4ThFQMvh5ZtSXY6aEJ1ohNxzvEAWN8elkoasoZJhWjj9zF&#10;-----END CERTIFICATE-----
                                                </textarea>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2"><button id="add-new-recipient" class="example">Добавить получателя</button></td>
                                        </tr>
                                    </table>
                                </li>
                                <li>
                                    <label for="encrypt-message">Сообщение</label>
                                    <textarea id="encrypt-message" class="text-input" rows="7">Зашифруй меня полностью</textarea>
                                </li>
                                <li>
                                    <label><input type="checkbox" name="in-base64"/>Данные в base64</label><br>
                                    <label><input type="checkbox" name="cms-encrypt-cipher" id="cms-encrypt-cipher"/>Алгоритм шифрования для RSA ключей</label>
                                    <select class="cms-encrypt-alg" id="cms-encrypt-alg" disabled=true>
                                        <option value="CIPHER_ALGORITHM_DES">DES</option>
                                        <option value="CIPHER_ALGORITHM_3DES">3DES</option>
                                        <option value="CIPHER_ALGORITHM_AES128">AES128</option>
                                        <option value="CIPHER_ALGORITHM_AES192">AES192</option>
                                        <option value="CIPHER_ALGORITHM_AES256">AES256</option>
                                    <select>
                                </li>
                                <li>
                                    <textarea id="encrypt-message-result" class="text-output" rows="7"></textarea>
                                </li>
                            </ul>
                        </div>
                        <div id="DecryptMessage" class="group">
                            <ul>
                                <li>
                                    <label for="decrypt-message">Сообщение</label>
                                    <textarea placeholder="Расшифруй меня полностью" id="decrypt-message" class="text-input" rows="7"></textarea>
                                </li>
                                <li>
                                    <label><input type="checkbox" name="in-base64" />Получить результат в base64</label><br>
                                </li>
                                <li>
                                    <textarea id="decrypt-message-result" class="text-output" rows="7"></textarea>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="dummy">
        <div id="bottom-bar-container">
        <div id="console-container">
            <div id="console"></div>
        </div>
        </div>

    </body>
</html>
<!-- vim: tabstop=4:softtabstop=4:shiftwidth=4:expandtab
        ->
